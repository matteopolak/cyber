## Utility
| Command | Explanation |
| --- | --- |
| `yes <password> \| passwd <user>` | Changes a user's password |
| `apt-cache search "game" \| grep -o "^[^ ]*"` | Returns all packages in API with "game" in the name or description. Use this to find all games on the system and delete them. |
| `yes <password> | grub-mkpasswd-pbkdf2 | cut -c33- | tr -d $'\n'` | Creates a pbkdf2 hash from a plaintext password. Use this to set up a grub password. |

## Commands
| Command | Explanation |
| --- | --- |
| `passwd -l root` | Disables the root account |
| `echo "allow-guest=false" >> /etc/lightdm/lightdm.conf` | Disables the guest account |
| `ufw enable` | Enables Ubuntu's [Uncomplicated Firewall](https://wiki.ubuntu.com/UncomplicatedFirewall) |
| `apt-get update` | Updates the APT package cache |
| `apt-get upgrade` | Upgrades all APT packages |
| `apt-get install tripwire apparmor apparmor-profiles iptables syslog-ng tripwire libpam-modules-bin ntp tcpd auditd libpam-cracklib libpam-modules logwatch postfix libdate-manip-perl rkhunter tiger clamav-daemon clamav p7zip-rar rarv unrar cron p7zip-full denyhosts -y` | Installs required packages |
| `chown root:root /boot/grub/grub.cfg`<br>`chmod 0400 /boot/grub/grub.cfg` | Fix grub configuration permissions |
| `sysctl -w "net.ipv6.conf.all.accept_source_route"="0"`<br>`sysctl -w "net.ipv6.conf.default.accept_source_route"="0"`<br>`sysctl -w "kernel.core_uses_pid"="1"`<br>`sysctl -w "kernel.panic"="10"`<br>`sysctl -w "net.ipv4.tcp_synack_retries"="5"`<br>`sysctl -w "net.ipv4.conf.all.send_redirects"="0"`<br>`sysctl -w "net.ipv4.conf.default.send_redirects"="0"`<br>`sysctl -w "net.ipv4.conf.all.accept_source_route"="0"`<br>`sysctl -w "net.ipv4.conf.all.accept_redirects"="0"`<br>`sysctl -w "net.ipv4.conf.all.secure_redirects"="0"`<br>`sysctl -w "net.ipv4.conf.all.log_martians"="1"`<br>`sysctl -w "net.ipv4.conf.default.accept_source_route"="0"`<br>`sysctl -w "net.ipv4.conf.default.accept_redirects"="0"`<br>`sysctl -w "net.ipv4.conf.default.secure_redirects"="0"`<br>`sysctl -w "net.ipv4.icmp_echo_ignore_broadcasts"="1"`<br>`sysctl -w "net.ipv4.tcp_syncookies"="1"`<br>`sysctl -w "net.ipv4.conf.all.rp_filter"="1"`<br>`sysctl -w "net.ipv4.conf.default.rp_filter "="1"`<br>`sysctl -w "net.ipv6.conf.default.router_solicitations"="0"`<br>`sysctl -w "net.ipv6.conf.default.accept_ra_rtr_pref"="0"`<br>`sysctl -w "net.ipv6.conf.default.accept_ra_pinfo"="0"`<br>`sysctl -w "net.ipv6.conf.default.accept_ra_defrtr"="0"`<br>`sysctl -w "net.ipv6.conf.default.autoconf"="0"`<br>`sysctl -w "net.ipv6.conf.default.dad_transmits"="0"`<br>`sysctl -w "net.ipv6.conf.default.max_addresses"="1"`<br>`sysctl -w "fs.file-max"="65535"`<br>`sysctl -w "kernel.pid_max"="65536"`<br>`sysctl -w "net.ipv4.ip_local_port_range"="2000 65000"`<br>`sysctl -w "net.ipv4.tcp_rfc1337"="1"`<br>`sysctl -w "net.ipv6.conf.lo.disable_ipv6"="1"`<br>`sysctl -w "net.ipv6.conf.all.disable_ipv6"="1"`<br>`sysctl -w "net.ipv6.conf.default.disable_ipv6"="1"`<br>`sysctl -w "net.ipv4.ip_forward"="0"`<br>`sysctl -w "net.ipv4.conf.default.accept_source_route"="0"`<br>`sysctl -w "kernel.sysrq"="0"`<br>`sysctl -w "fs.protected_hardlinks"="1"`<br>`sysctl -w "fs.protected_symlinks"="1"`<br>`sysctl -w "net.ipv4.icmp_ignore_bogus_error_responses"="1"`<br>`sysctl -w "kernel.exec-shield"="1"`<br>`sysctl -w "kernel.randomize_va_space"="2"`<br>`sysctl -w "net.ipv4.icmp_echo_ignore_all"="1"`<br>`sysctl -w "net.ipv4.conf.default.log_martians"="1"`<br>`sysctl -w "net.core.rmem_max"="8388608"`<br>`sysctl -w "net.core.wmem_max"="8388608"`<br>`sysctl -w "net.ipv4.tcp_rmem"="10240 87380 12582912"`<br>`sysctl -w "net.ipv4.tcp_wmem"="10240 87380 12582912"`<br>`sysctl -w "net.core.netdev_max_backlog"="5000"`<br>`sysctl -w "net.ipv4.tcp_window_scaling"="1"`<br>`sysctl -w "net.ipv6.conf.all.accept_ra"="0"`<br>`sysctl -w "net.ipv6.conf.default.accept_ra"="0"`<br>`sysctl -w "fs.suid_dumpable"="0"` | Configures appropriate sysctl settings |
| `apt-get purge prelink nis rsh-client rsh-redone-client heimdal-clients talk inetutils-talk openbsd-inetd xinetd rlinetd udhcpd isc-dhcp-server tightvncserver vnc4server fglrx-driver xvfb xnest snmpd slapd squid3 squid citadel-server courier-imap cyrus-imapd-2.4 dovecot-imapd mailutils-imap4d courier-pop cyrus-pop3d-2.4 dovecot-pop3d heimdal-servers mailutils-pop3d popa3d solid-pop3d xmail lighttpd micro-httpd mini-httpd yaws boa bozohttpd ftpd ftpd-ssl heimdal-servers inetutils-ftpd krb5-ftpd muddleftpd proftpd-basic pure-ftpd pure-ftpd-ldap pure-ftpd-mysql pure-ftpd-postgresql twoftpd-run vsftpd wzdftpd bind9 unbound rpcbind nfs-kernel-server netcat nc netcat-* ophcrack -y` | Purges unnecessary packages |
| `printf "#!/bin/sh\nexec tail -n +3 \$0\n\nset superusers=\"root\"\npassword_pbkdf2 root <pbkdf2 hash>" > /etc/grub.d/40_custom` | Sets the grub password from a pbkdf2 hash. To generate a hash, look at **Utility** |
| `sed -i '/ADMIN_EMAIL/d' /etc/denyhosts.conf`<br>`sed -i '/SMTP_FROM/d' /etc/denyhosts.conf`<br>`echo "ADMIN_EMAIL = pretendthisemailexists@gmail.com"`<br>`echo "SMTP_FROM = denyhostnotifications@gmail.com"`<br>`/etc/init.d/denyhosts restart` | Updates denyhosts logging information and restarts the service. |
| `echo 'APT::Periodic::Update-Package-Lists "1";' > /etc/apt/apt.conf.d/20auto-upgrades;`<br>`echo 'APT::Periodic::Download-Upgradeable-Packages "1";' >> /etc/apt/apt.conf.d/20auto-upgrades;`<br>`echo 'APT::Periodic::AutocleanInterval "7";' >> /etc/apt/apt.conf.d/20auto-upgrades;`<br>`echo 'APT::Periodic::Unattended-Upgrade "1";' >> /etc/apt/apt.conf.d/20auto-upgrades;`<br>`unattended-upgrades --dry-run --debug` | Enables daily automatic updates and starts a dry run |
| `echo "X11Forwarding=no" >> /etc/ssh/sshd_config`<br>`echo "Ciphers=aes128-ctr,aes192-ctr,aes256-ctr" >> /etc/ssh/sshd_config`<br>`echo "PermitUserEnvironment=no" >> /etc/ssh/sshd_config`<br>`echo "PermitEmptyPasswords=no" >> /etc/ssh/sshd_config`<br>`echo "PermitRootLogin=no" >> /etc/ssh/sshd_config`<br>`echo "HostbasedAuthentication=no" >> /etc/ssh/sshd_config`<br>`echo "IgnoreRhosts=yes" >> /etc/ssh/sshd_config`<br>`echo "MaxAuthTries=4" >> /etc/ssh/sshd_config`<br>`echo "ClientAliveInterval=10" >> /etc/ssh/sshd_config`<br>`echo "ClientAliveCountMax=0" >> /etc/ssh/sshd_config`<br>`echo "AllowUsers=" >> /etc/ssh/sshd_config`<br>`echo "AllowGroups=sshlogin" >> /etc/ssh/sshd_config`<br>`echo "DenyUsers=root" >> /etc/ssh/sshd_config`<br>`echo "DenyGroups=root" >> /etc/ssh/sshd_config`<br>`echo "UsePAM=yes" >> /etc/ssh/sshd_config`<br>`echo "Protocol=2" >> /etc/ssh/sshd_config`<br>`echo "RhostsRSAAuthentication=no" >> /etc/ssh/sshd_config`<br>`echo "RhostsAuthentication=no" >> /etc/ssh/sshd_config`<br>`echo "LoginGraceTime=1m" >> /etc/ssh/sshd_config`<br>`echo "SyslogFacility=AUTH" >> /etc/ssh/sshd_config`<br>`echo "MaxStartups=5" >> /etc/ssh/sshd_config`<br>`echo "PASS_WARN_AGE=7" >> /etc/login.defs`<br>`echo "PASS_MIN_DAYS=7" >> /etc/login.defs`<br>`echo "PASS_MAX_DAYS=90" >> /etc/login.defs`<br>`echo "PASS_MIN_LEN 8" >> /etc/login.defs` | Configures OpenSSH appropriately |
| `rkhunter --update && rkhunter --propupd && rkhunter --check --nocolours --skip-keypress` | Scans the system with RKHunter. View log file for helpful output |
| `tiger -e` | Scans the system with Tiger. Use this as a last-ditch effort |
| `logwatch` | Enables logwatch |
| `apparmor_status` | Enables AppArmor |
| `iptables -A INPUT -p tcp --syn --dport 22 -m connlimit --connlimit-above 3 -j REJECT >> $LOG_FILE 2>&1;`<br>`iptables -p tcp --syn --dport 80 -m connlimit --connlimit-above 20 --connlimit-mask 24 -j DROP >> $LOG_FILE 2>&1;` | Basic IPTables configurations |
| `apt-get update -y`<br>`apt-get full-upgrade-y`<br>`apt-get autoremove -y`<br>`apt-get autoclean -y` | Updates package cache, packages, and performs cleanup |